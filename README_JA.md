# Google Classroom Discovery Tool (GAS)

**Google Classroom のファイルをスプレッドシート上で効率的に整理・管理するツール**

このツールを使えば、Classroomで配布される授業ワークシートのショートカットから元のファイルを検出し、My Drive 内にあるファイルどこにでも自動で移動させることができます。
## ✨ 主な機能

*   **授業WSの自動検出**: Google ドライブ内の `Classroom` フォルダを自動検索し、授業WS一覧をリストアップします。
*   **ショートカットの完全解決**: ドライブ上のショートカット (`.shortcut`) を認識し、そのリンク先にある**実体ファイル**を操作対象として扱います。
*   **一括移動**: スプレッドシートに移動先フォルダの URL を貼り付けるだけで、指定したフォルダへファイルを一括移動します。
*   **ファイル名の同期**: ショートカット側でファイル名を変更していても安心です。移動時に、実体ファイルの名前をショートカットの名前に自動で同期（リネーム）します。
*   **安全設計**: 操作対象は**自分（実行ユーザー）がオーナーのファイル**に限定されます。共有ファイルや他人のファイルを誤って変更することはありません。

---

## 🛠 セットアップ

このツールは Google スプレッドシートの拡張機能（Apps Script）として動作します。

1.  **新規スプレッドシートの作成**: Google スプレッドシートを新規作成します（名前は任意です。例: `Classroom Manager`）。
2.  **スクリプトエディタを開く**: メニューの **拡張機能 > Apps Script** をクリックします。
3.  **コードの貼り付け**: [`Code_JA.gs`](./Code_JA.gs) の内容をコピーし、エディタに貼り付けてください（元のコードは削除）。
4.  **保存**: ツールバーのディスクアイコン（💾）をクリックしてプロジェクトを保存します。

---

## 🚀 使い方

スプレッドシートをリロードすると、メニューバーに **「🎓 授業WSマネージャー」** という項目が追加されます。
※ 初回実行時は、Google アカウントへのアクセス権限の承認（Authorization）画面が表示されます。画面の指示に従って許可してください。

### 1. 授業WSを探す
*   メニューから **「1. 授業WSを探す」** を実行します。
*   `Classroom` フォルダ内にあるサブフォルダ（授業WS）が自動的に検出され、シートに一覧表示されます。

### 2. ファイルを取得
*   A列のチェックボックスを使い、整理したい授業WSを**1つだけ選択**します。
*   メニューから **「2. 選択した授業WSからファイルを取得」** を実行します。
*   その授業WSフォルダ内のファイルがリストアップされます（ショートカットが含まれる場合、自動的に実体ファイルの情報が取得されます）。

### 3. ファイルを移動
*   移動させたいファイルの **C列（移動先フォルダURL）** に、移動先の Google ドライブフォルダの URL を貼り付けます。
*   メニューから **「3. ファイルを移動」** を実行します。
*   処理が完了するとステータスが「完了」に更新され、ファイルが移動します。この際、ショートカット側で名前を変更していた場合は、実体ファイルの名前もそれに合わせて自動的に変更されます。

## ⚠️ 注意点

*   **所有権の確認**: このスクリプトは、データの安全性を考慮し、**あなた自身がオーナー権限を持つファイル**のみを操作します。先生から配布された資料（閲覧権限のみ）などは「スキップ (所有権なし)」と表示され、移動や変更は行われません。
*   **フォルダ名**: デフォルト設定では、マイドライブ直下の「Classroom」という名前のフォルダを検索します。もしフォルダ名が異なる場合は、コード冒頭の `var ROOT_FOLDER_NAME = "Classroom";` の部分を実際のフォルダ名に書き換えてください。

---
*Created by Gemini CLI Agent*
